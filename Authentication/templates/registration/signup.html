{% extends 'base.html' %}
{% load static %}
{% block content %}
<body class="bg-dark text-white pl-2 pr-2 pt-2" style="font-family: sans;">
  {% include 'v_1_0/toasts/error_toast.html' %}
  <div class="text-center"><img class="rounded-circle mb-3 mr-2" src="{% static 'img/logo/logo_v_1_0.png' %}" width='40px' height='40px'> <span class="text-32 bundle font-weight-bold"> Havwis</span></div>
  <section class="">
    <div class="r-100 m-4 p-1 text-center text-light text-opacity border border-dark">https://www.havwis.com/register</div>
    <form action="/account/register/" class="bg-white text-body rounded p-2" method="POST">
      {% csrf_token %}
      <p class="text-center text-20">Create an account</p>
      <div class="p-2">
        <label class="allred font-weight-bold" for="name">Name</label>
        <div class="form-row">
          <input id="first_name" name="first_name" class="col form-control shadow-none mr-1" placeholder="First Name">
          <input id="last_name" name="last_name" class="col form-control shadow-none ml-1" placeholder="Last Name">
        </div>
      </div>
      <div class="p-2">
        <label class="font-weight-bold allred" for="name">Email</label>
        <div class="form-row">
          <input id="email" name="email" class="col form-control shadow-none mr-1" placeholder="Email">
        </div>
      </div>
      <div class="p-2">
        <label class="font-weight-bold allred" for="name">Phone number</label>
        <div class="form-row">
          <input id="phone_number" name="phone_number" class="col form-control shadow-none mr-1" placeholder="+234 90XXXXXXXX">
        </div>
      </div>
      <div class="p-2">
        <label class="font-weight-bold allred" for="name">Password</label>
        <div class="form-row">
          <input id="password1" name="password1" class="col form-control shadow-none mr-1" placeholder="Password">
        </div>
      </div>
      <div class="p-2">
        <label class="font-weight-bold allred" for="name">Password Again</label>
        <div class="form-row">
          <input id="password2" name="password2" class="col form-control shadow-none mr-1" placeholder="Confirm again">
        </div>
      </div>
      <button type="button" class="mt-3 btn btn-primary btn-lg text-14 font-weight-bold shadow-none btn-block" disabled>Create an account</button>
      <p class="allre m-2">By clicking create an account , you agree to our terms and conditions using Havwis.</p>
    </form>
    <div class="mt-4 mb-4 text-center">
      <a href="#" class="allred text-white font-weight-bold text-16">Already have a havwis account? <span href="#" class="text-14 text-white"> Login</span> </a>
    </div>
    {% include 'modals/set_tx_pin.html' %}
  </section>
  <script>
    $("input").on("keyup", function(){
      if($("#email").val().trim().length > 0 && $("#password1").val().trim().length > 0 && $("#password2").val().trim().length > 0 && $("#first_name").val().trim().length > 0 && $("#last_name").val().trim().length > 0){
        $("button").prop("disabled", false);
      }else{
        $("button").prop("disabled", true);
      }
    });
    $("button").on("click", function(){
      let error = "";
      $(this).html("<span class='spinner-grow spinner-grow-sm text-white p-0'> </span>")
      $.post("/account/register/", {"csrfmiddlewaretoken":"{{csrf_token}}", "email":$("#email").val(), "phone_number":$("#phone_number").val(), "first_name":$("#first_name").val(), "last_name":$("#last_name").val(), "password1":$("#password1").val(), "password2":$("#password2").val()}, function(data,status){
        if(data.status){
          $("#modal_tx_pin").modal("show");
        }else{
          for(let key in data.errors){
            if(data.errors.hasOwnProperty(key)) {
              error += data.errors[key]+"<br>";
            }
          }
        toast(true, error);
        $("button").html("Create an account");
        }
      });
    });
  </script>
</body>
{% endblock %}